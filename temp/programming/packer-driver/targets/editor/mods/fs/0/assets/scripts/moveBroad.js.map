{"version":3,"sources":["file:///Users/wuyachong/Desktop/fight/fight/assets/scripts/moveBroad.ts"],"names":["Component","Node","RigidBody2D","systemEvent","SystemEvent","Vec2","_decorator","ccclass","property","MoveBroad","type","onLoad","on","EventType","MOUSE_MOVE","onMouseMove","MOUSE_UP","onMouseUp","event","mousePositionX","getUILocationX","notShoot","shoot","update","node","setWorldPosition","getWorldPosition","y","ball","rigidBody","getComponent","center","linearVelocity","start"],"mappings":";;;;;;;;;;;;;;;;AACSA,MAAAA,S,OAAAA,S;AAAuBC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,U,OAAAA,U;;;;;;;OAC7E;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBF,U;;2BAGjBG,S,WADZF,OAAO,CAAC,WAAD,C,UAGHC,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAET;AAAR,OAAD,C,oCAHb,MACaQ,SADb,SAC+BT,SAD/B,CACyC;AAAA;AAAA;;AAAA;;AAAA,kDAMZ,GANY;;AAAA,4CASlB,IATkB;AAAA;;AAWrCW,QAAAA,MAAM,GAAG;AACL;AACAR,UAAAA,WAAW,CAACS,EAAZ,CAAeR,WAAW,CAACS,SAAZ,CAAsBC,UAArC,EAAiD,KAAKC,WAAtD,EAAmE,IAAnE;AACAZ,UAAAA,WAAW,CAACS,EAAZ,CAAeR,WAAW,CAACS,SAAZ,CAAsBG,QAArC,EAA+C,KAAKC,SAApD,EAA+D,IAA/D;AACH;;AAEDF,QAAAA,WAAW,CAACG,KAAD,EAAoB;AAC3B,eAAKC,cAAL,GAAsBD,KAAK,CAACE,cAAN,EAAtB;AACH;;AAEDH,QAAAA,SAAS,CAACC,KAAD,EAAoB;AACzB,cAAI,KAAKG,QAAT,EAAmB;AACf,iBAAKC,KAAL;AACH;AACJ;;AAEDC,QAAAA,MAAM,GAAG;AACL;AACA,eAAKC,IAAL,CAAUC,gBAAV,CAA2B,KAAKN,cAAhC,EAAgD,KAAKK,IAAL,CAAUE,gBAAV,GAA6BC,CAA7E,EAAgF,CAAhF;;AACA,cAAI,KAAKN,QAAT,EAAmB;AAAA;;AACf,+BAAKO,IAAL,0DAAWH,gBAAX,CAA4B,KAAKN,cAAjC,EAAiD,KAAKS,IAAL,CAAUF,gBAAV,GAA6BC,CAA9E,EAAiF,CAAjF;AACH;AACJ;;AAEDL,QAAAA,KAAK,GAAG;AAAA;;AACJ;AACA,cAAIO,SAAS,kBAAG,KAAKD,IAAR,gDAAG,YAAWE,YAAX,CAAwB5B,WAAxB,CAAhB;AACA,cAAI6B,MAAM,GAAG,IAAI1B,IAAJ,CAAS,EAAT,EAAa,EAAb,CAAb;AACAwB,UAAAA,SAAS,CAACG,cAAV,GAA2BD,MAA3B;AACA,eAAKV,QAAL,GAAgB,KAAhB;AACH;;AAEDY,QAAAA,KAAK,GAAG,CACJ;AACH;;AA7CoC,O;;;;;iBAGV,I","sourcesContent":["\r\nimport { Component, EventMouse, Node, RigidBody2D, systemEvent, SystemEvent, Vec2, _decorator } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('MoveBroad')\r\nexport class MoveBroad extends Component {\r\n\r\n    @property({ type: Node })\r\n    public ball: Node | null = null;\r\n\r\n    // 鼠标初始位置\r\n    private mousePositionX = 480;\r\n\r\n    // 还没发射\r\n    private notShoot = true;\r\n\r\n    onLoad() {\r\n        // 注册鼠标移动事件\r\n        systemEvent.on(SystemEvent.EventType.MOUSE_MOVE, this.onMouseMove, this);\r\n        systemEvent.on(SystemEvent.EventType.MOUSE_UP, this.onMouseUp, this);\r\n    }\r\n\r\n    onMouseMove(event: EventMouse) {\r\n        this.mousePositionX = event.getUILocationX();\r\n    }\r\n\r\n    onMouseUp(event: EventMouse) {\r\n        if (this.notShoot) {\r\n            this.shoot();\r\n        }\r\n    }\r\n\r\n    update() {\r\n        // 节点坐标与鼠标坐标一致\r\n        this.node.setWorldPosition(this.mousePositionX, this.node.getWorldPosition().y, 0);\r\n        if (this.notShoot) {\r\n            this.ball?.setWorldPosition(this.mousePositionX, this.ball.getWorldPosition().y, 0);\r\n        }\r\n    }\r\n\r\n    shoot() {\r\n        // 获取世界坐标系下的刚体质心\r\n        let rigidBody = this.ball?.getComponent(RigidBody2D) as RigidBody2D;\r\n        let center = new Vec2(10, 10);\r\n        rigidBody.linearVelocity = center;\r\n        this.notShoot = false;\r\n    }\r\n\r\n    start() {\r\n        // [3]\r\n    }\r\n\r\n}\r\n"]}